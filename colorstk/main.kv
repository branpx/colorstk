#:import join os.path.join

#:import App kivy.app.App
#:import Window kivy.core.window.Window
#:import Factory kivy.factory.Factory
#:import icon kivy.garden.iconfonts.icon
#:import knspace kivy.uix.behaviors.knspace.knspace


#:set pkg_dir App.get_running_app().pkg_dir


<PopupWithActionBar>:
    orientation: 'vertical'
    background: ''

    canvas:
        Color:
            rgba: 0.2, 0.2, 0.2, 1
        Rectangle:
            pos: self.pos
            size: self.size

    ActionBar:
        id: action_bar
        ActionView:
            ActionPrevious:
                title: root.title
                app_icon: root.icon
                app_icon_width: '32dp'
                app_icon_height: '32dp'
                on_release: root.dismiss()


<AboutPopup>:
    title: 'About'
    icon: join(pkg_dir, 'data/about.png')
    size_hint: 0.6, 0.8

    TextInput:
        text:
            """Colors Toolkit\n
            Copyright (c) 2017 Brandon Piatt\n
            """
        foreground_color: 1, 1, 1, 1
        background_color: 0, 0, 0, 0
        cursor_color: 0, 0, 0, 0
        readonly: True


<OptionsTogglePopup>:
    size_hint: 0.6, None
    max_height: Window.height * 0.8

    ScrollView:
        GridLayout:
            id: toggle_button_grid
            cols: 1
            size_hint_y: None
            height: self.minimum_height
            on_height: root.set_height(self.height)


<ToggleButton>:
    background_color: 0.75, 0.75, 0.75, 1


<SettingToggle>:
    CheckBox:
        id: check_box
        active:
            bool(root.values.index(root.value)) \
            if root.value in root.values else False
        on_active: root.value = root.values[int(args[1])]


<-SettingsPanel>:
    size_hint_y: None
    height: self.minimum_height
    padding: '5dp'
    spacing: '5dp'


<ScreenMenu@ModalView>:
    pos_hint: {'x': 0, 'y': 0}
    size_hint_x: None
    width: '300dp'
    background: ''

    screen_manager: App.get_running_app().root

    canvas:
        Color:
            rgba: 0.15, 0.15, 0.15, 1
        Rectangle:
            pos: self.pos
            size: self.size

    GridLayout:
        cols: 1

        ScreenMenuItem:
            text: '[size=20dp]%s[/size]        Lookup' % icon('icon_lookup')
            on_release: root.screen_manager.current = 'lookup'; root.dismiss()
        ScreenMenuItem:
            text: '[size=20dp]%s[/size]        Palettes' % icon('icon_palettes')
            on_release: root.screen_manager.current = 'palettes'; root.dismiss()
        ScreenMenuItem:
            text: '[size=20dp]%s[/size]        Settings' % icon('icon_settings')
            on_release: App.get_running_app().open_settings(); root.dismiss()
        ScreenMenuItem:
            text: '[size=20dp]%s[/size]        About' % icon('icon_about')
            on_release: Factory.AboutPopup().open(); root.dismiss()


<ScreenMenuItem@Button>:
    size_hint_y: None
    height: '60dp'
    background_normal: join(pkg_dir, 'data/menu_button.png')
    background_down: join(pkg_dir, 'data/plain_button_down.png')
    text_size: self.size[0]*0.9, None
    color: 0.75, 0.75, 0.75, 1
    halign: 'left'
    markup: True


<ActionItem>:
    background_down: join(pkg_dir, 'data/plain_button_down.png')


<ActionPreviousButton>:
    background_down: self.background_normal


<ActionDropDown>:
    canvas:
        Color:
            rgba: 0.1, 0.1, 0.1, 1
        Rectangle:
            pos: self.pos
            size: self.size
