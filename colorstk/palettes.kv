<PalettesScreen>:
    knsname: 'palettes_screen'
    orientation: 'vertical'

    canvas:
        Color:
            rgba: 0, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size

    ActionBar:
        ActionView:
            id: action_view
            ActionPrevious:
                id: action_previous
                on_release: root.on_action_previous()
            ActionButton:
                id: new_button
                text: 'New'
                on_release: Factory.NewPalettePopup().open()

    ScrollView:
        SelectableStack:
            id: palette_stack
            size_hint_min_x: '200dp'
            size_hint_y: None
            height: self.minimum_height
            padding: '25dp', '25dp'
            spacing: '25dp'
            multiselect: True
            touch_multiselect: True


<ColorsScreen>:
    knsname: 'colors_screen'
    orientation: 'vertical'

    ActionBar:
        ActionView:
            id: action_view
            ActionPrevious:
                id: action_previous
                on_release: root.on_action_previous()

    ScrollView:
        SelectableStack:
            id: color_stack
            size_hint_min_x: '130dp'
            size_hint_y: None
            height: self.minimum_height
            padding: '15dp', '15dp'
            spacing: '15dp'
            multiselect: True
            touch_multiselect: True

<Palette>:
    cols: 1
    size_hint: None, None
    size: '150dp', '175dp'
    title_size: '15dp'
    background_color: 0.2, 0.2, 0.2, 1

    canvas:
        Color:
            rgba: self.background_color
        Rectangle:
            pos: self.pos
            size: self.size

    FloatLayout:
        size_hint_y: None
        height: '100dp'

        canvas:
            Color:
                rgba: 0.1, 0.1, 0.1, 1
            Rectangle:
                pos: self.pos
                size: self.size

        PalettePreviewColor:
            pos_hint: {'center_x': 0.70, 'center_y': 0.70}
            color: root.colors[2] if len(root.colors) > 2 else (0.1, 0.1, 0.1)
        PalettePreviewColor:
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            color: root.colors[1] if len(root.colors) > 1 else (0.1, 0.1, 0.1)
        PalettePreviewColor:
            pos_hint: {'center_x': 0.30, 'center_y': 0.30}
            color: root.colors[0] if len(root.colors) > 0 else (0.1, 0.1, 0.1)

    Label:
        text: root.name
    Label:
        color: 0.7, 0.7, 0.7, 1
        text: str(len(root.colors)) + ' colors'


<PaletteColor>:
    size_hint: None, None
    size: '100dp', '100dp'
    border_color: 0.3, 0.3, 0.3, 1

    canvas.before:
        Color:
            rgb: self.color
        Rectangle:
            pos: self.pos
            size: self.size

    canvas:
        Color:
            rgba: self.border_color
        Line:
            rectangle: self.x, self.y, self.width, self.height
            width: dp(2)
            joint: 'miter'


<PalettePreviewColor@Widget>:
    size_hint: None, None
    size: '50dp', '50dp'
    color: 0.1, 0.1, 0.1

    canvas.before:
        Color:
            rgb: self.color
        Rectangle:
            pos: self.pos
            size: self.size

    canvas:
        Color:
            rgba: 0.2, 0.2, 0.2, 1
        Line:
            rectangle: self.x, self.y, self.width, self.height
            width: dp(2)
            joint: 'miter'


<NewPalettePopup>:
    title: 'Palette Name'
    size_hint: None, None
    size: '200dp', '90dp'

    TextInput:
        id: name_input
        size_hint_y: None
        height: '30dp'
        cursor_color: 0, 0, 0, 1
        multiline: False
        write_tab: False
        on_text_validate: root.add_palette(self)
